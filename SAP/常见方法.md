一、**选择光标所在行**<br>
```
DATA: lt_row  TYPE lvc_t_row,
   ls_row  TYPE lvc_s_row,
   lt_roid TYPE lvc_t_roid,
   ls_roid TYPE lvc_s_roid.
DATA:ls_zver_itab TYPE zco_t_430_ver.

CALL METHOD grid->get_selected_rows
   IMPORTING
      et_index_rows = lt_row
      et_row_no     = lt_roid.
IF lt_row[] IS INITIAL.
    MESSAGE '请选择你需要删除的行项目' TYPE 'I'.
    RETURN.
ENDIF.
DESCRIBE TABLE lt_row LINES DATA(t1).

IF t1 <>  1.
  MESSAGE '只能选择一行数据，进行删除版本' TYPE 'E'.
ENDIF.

READ TABLE lt_row INTO ls_row INDEX 1.
READ TABLE zver_itab INTO ls_zver_itab INDEX ls_row-index.
IF sy-subrc EQ 0.
   DELETE zco_t_430_ver FROM ls_zver_itab.
   IF sy-subrc EQ 0.
     DELETE zver_itab INDEX ls_row-index.
   ENDIF.
ENDIF.

DELETE FROM zco_t_sc430_11 WHERE werks EQ ls_zver_itab-werks AND twerks EQ ls_zver_itab-twerks AND zver EQ ls_zver_itab-zver.

IF sy-subrc EQ 0 .
   MESSAGE '数据删除成功' TYPE 'S'.
ELSE.
   MESSAGE '数据删除失败' TYPE 'E'.
ENDIF.
```

**二、使用up to**<br>
```
SELECT * FROM LIKP INTO TABLE LT_LIKP UP TO 20 ROWS WHERE VSTEL EQ WERKS ORDER BY LFDAT .
```

**三、序列化和反序列化**<br>
```
CALL METHOD /UI2/CL_JSON=>SERIALIZE
   EXPORTING
     DATA   = WA_ZJHPS_LINES
   RECEIVING
     R_JSON = LV_JSON.


CALL METHOD /UI2/CL_JSON=>DESERIALIZE
    EXPORTING
      JSON = VBANDMN
    CHANGING
      DATA = LT_VBANDMN.
```

**四、调用事务代码**<br>
```
DATA LR_PAY_DATA TYPE REF TO DATA.
FIELD-SYMBOLS <LT_PAY_DATA> TYPE ANY TABLE.
DATA LT_VALUTAB TYPE STANDARD TABLE OF RSPARAMS.
DATA LS_VALUTAB TYPE RSPARAMS.

CLEAR LS_VALUTAB.
LS_VALUTAB-SELNAME = 'WERKS'.
LS_VALUTAB-KIND = 'P'.
LS_VALUTAB-SIGN = 'I'.
LS_VALUTAB-OPTION = 'EQ'.
LS_VALUTAB-LOW = WERKS.
APPEND LS_VALUTAB TO LT_VALUTAB.

CLEAR LS_VALUTAB.
LS_VALUTAB-SELNAME = 'AUFNR'.
LS_VALUTAB-KIND = 'S'.
LS_VALUTAB-SIGN = 'I'.
LS_VALUTAB-OPTION = 'EQ'.
LS_VALUTAB-LOW =  LS_ZAUFM-AUFNR.
APPEND LS_VALUTAB TO LT_VALUTAB.

CLEAR LS_VALUTAB.
LS_VALUTAB-SELNAME = 'ZDATE'.
LS_VALUTAB-KIND = 'S'.
LS_VALUTAB-SIGN = 'I'.
LS_VALUTAB-OPTION = 'BT'.
LS_VALUTAB-LOW =  ZDATE-LOW.
LS_VALUTAB-HIGH =  ZDATE-HIGH.
APPEND LS_VALUTAB TO LT_VALUTAB.

CLEAR LS_VALUTAB.
LS_VALUTAB-SELNAME = 'A1'.
LS_VALUTAB-KIND = 'P'.
LS_VALUTAB-SIGN = 'I'.
LS_VALUTAB-LOW =  'X'.
APPEND LS_VALUTAB TO LT_VALUTAB.

CLEAR LS_VALUTAB.
LS_VALUTAB-SELNAME = 'A7'.
LS_VALUTAB-KIND = 'P'.
LS_VALUTAB-SIGN = 'I'.
LS_VALUTAB-LOW =  'X'.
APPEND LS_VALUTAB TO LT_VALUTAB.

CL_SALV_BS_RUNTIME_INFO=>SET( EXPORTING DISPLAY = ABAP_FALSE
                                       METADATA = ABAP_TRUE
                                           DATA = ABAP_TRUE ).

SUBMIT ZWGTJN
    WITH SELECTION-TABLE LT_VALUTAB
    AND RETURN.
TRY .
    CL_SALV_BS_RUNTIME_INFO=>GET_DATA_REF( IMPORTING R_DATA = LR_PAY_DATA ).
    ASSIGN LR_PAY_DATA->* TO <LT_PAY_DATA>.
    IF  NOT  <LT_PAY_DATA> IS ASSIGNED. "如果查询不到数据，那就将设置原
       CL_SALV_BS_RUNTIME_INFO=>CLEAR_ALL( ).
       PERFORM FILL_CELL_SN USING 5 LISTINDEX '0'.
       PERFORM FILL_CELL_SN USING 6 LISTINDEX '100%'.
    ELSE.
       CREATE DATA WA LIKE LINE OF <LT_PAY_DATA>.
       ASSIGN WA->* TO <FS>.
       REFRESH:ITAB.

       LOOP AT <LT_PAY_DATA> ASSIGNING <FS>.
          MOVE-CORRESPONDING <FS> TO ITAB.
          APPEND ITAB.
       ENDLOOP.

       TABLE_INDEX = 0.
       BFSL = 0.
       LOOP AT ITAB.
           TABLE_INDEX = TABLE_INDEX + 1.
       ENDLOOP.

       IF TABLE_INDEX EQ 1.
           PERFORM FILL_CELL_SN USING 5 LISTINDEX '0'.
           PERFORM FILL_CELL_SN USING 6 LISTINDEX '100%'.
       ELSE.
           SORT ITAB BY ZSL DESCENDING.
           LOOP AT ITAB.
              IF ITAB-ZQX NE 'A'.
                BFSL = BFSL + ITAB-ZSL.
              ENDIF.
              IF ITAB-ZQX EQ 'A'.
                PERFORM FILL_CELL_SN USING 6 LISTINDEX ITAB-HGL.
              ENDIF.
           ENDLOOP.
           " 报废量
           PERFORM FILL_CELL_SN USING 5 LISTINDEX BFSL.
           LOOP AT ITAB INTO W_ITAB.
             IF W_ITAB-ZQX NE 'A'.
               APPEND W_ITAB TO BL_ITAB.
             ENDIF.
           ENDLOOP.
           SORT BL_ITAB BY ZSL DESCENDING.
           LOOP AT BL_ITAB.
              IF SY-TABIX <= 3.
                DATA(C) = SY-TABIX + 6.
                PERFORM FILL_CELL_SN USING C LISTINDEX BL_ITAB-ZQX.
              ENDIF.
            ENDLOOP.
       ENDIF.
     ENDIF.
CATCH CX_SALV_BS_SC_RUNTIME_INFO. 
```